<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PMLogin - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="../../assets/theme.css">
    <link rel="stylesheet" href="../../assets/components.css">
    <link rel="stylesheet" href="../../assets/profiles_structure.css">
    <link rel="stylesheet" href="../../assets/profiles_view.css">
    <link rel="stylesheet" href="../../assets/button-components.css">
    <style id="componentStyles"></style>
    <style>
        /* Main page specific styles - using theme variables */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        /* Sidebar specific styles */
        .sidebar {
            background: linear-gradient(180deg, #1e293b 0%, #334155 100%);
            transition: all 0.3s ease;
        }
        
        .sidebar .text-center h1 {
            background: var(--pmlogin-gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            letter-spacing: -0.025em;
        }
        
        .sidebar-item {
            transition: all 0.2s ease;
        }
        
        .sidebar-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(4px);
        }
        
        .sidebar-item.active {
            background: rgba(34, 197, 94, 0.2);
            border-right: 3px solid var(--pmlogin-primary);
        }
        
        /* Main content area */
        .content-area {
            background: var(--pmlogin-bg-secondary);
            min-height: 100vh;
        }
        
        /* Card styles - needed for dashboard */
        .card {
            background: var(--pmlogin-bg-card);
            border-radius: 12px;
            box-shadow: var(--pmlogin-shadow-default);
            transition: all 0.2s ease;
        }
        
        .card:hover {
            box-shadow: var(--pmlogin-shadow-md);
        }
        
        /* Dashboard specific stat cards */
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .stat-card.green {
            background: var(--pmlogin-gradient-primary);
        }
        
        .stat-card.blue {
            background: var(--pmlogin-gradient-secondary);
        }
        
        .stat-card.orange {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        /* Notification styles - needed for main page */
        .notification {
            transform: translateY(-100%);
            transition: all 0.3s ease;
        }
        
        .notification.show {
            transform: translateY(0);
        }
        
        /* Table container - needed for tables */
        .table-container {
            max-height: 400px;
            overflow-y: auto;
        }
        
        /* Status badges - needed for status display */
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-working {
            background: var(--pmlogin-success-bg);
            color: var(--pmlogin-success-text);
        }
        
        .status-failed {
            background: var(--pmlogin-error-bg);
            color: var(--pmlogin-error-text);
        }
        
        .status-untested {
            background: var(--pmlogin-gray-100);
            color: var(--pmlogin-gray-700);
        }

        /* Enhanced Profiles View Styles - needed for profiles */
        .profiles-main-view {
            display: flex;
            flex-direction: column;
            height: 100%;
            padding: 20px;
            background-color: var(--pmlogin-bg-secondary);
        }

        .profiles-header-section {
            background: var(--pmlogin-bg-card);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--pmlogin-shadow-default);
        }

        .profiles-content-section {
            flex: 1;
            background: var(--pmlogin-bg-card);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--pmlogin-shadow-default);
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .profiles-taskbar-container {
            margin-bottom: 20px;
        }

        .profiles-table-wrapper {
            flex: 1;
            min-height: 0;
        }
        
        /* Debug panel specific to main page */
        .debug-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 300px;
            background: var(--pmlogin-bg-card);
            border: 2px solid var(--pmlogin-primary);
            border-radius: 8px;
            padding: 12px;
            box-shadow: var(--pmlogin-shadow-lg);
            z-index: 1000;
            font-family: monospace;
            font-size: 11px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .debug-header {
            background: var(--pmlogin-primary);
            color: var(--pmlogin-text-white);
            padding: 6px 10px;
            margin: -12px -12px 12px -12px;
            border-radius: 6px 6px 0 0;
            font-weight: bold;
        }
        
        .debug-item {
            margin: 6px 0;
            padding: 4px 6px;
            background: var(--pmlogin-gray-100);
            border-radius: 4px;
        }
        
        .debug-success {
            background: var(--pmlogin-success-bg);
            color: var(--pmlogin-success-text);
        }
        
        .debug-error {
            background: var(--pmlogin-error-bg);
            color: var(--pmlogin-error-text);
        }
        
        .debug-warning {
            background: var(--pmlogin-warning-bg);
            color: var(--pmlogin-warning-text);
        }
        
        .debug-button {
            background: var(--pmlogin-secondary);
            color: var(--pmlogin-text-white);
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            margin: 2px 1px;
            font-size: 10px;
        }
        
        .debug-button:hover {
            background: var(--pmlogin-secondary-dark);
        }
        
        /* Settings dropdown specific */
        #settingsDropdown {
            animation: fadeIn 0.2s ease-out;
        }
        
        #settingsIcon {
            margin-left: 50px;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        #settingsDropdown a:hover,
        #settingsDropdown button:hover {
            background-color: var(--pmlogin-gray-100);
            transition: background-color 0.2s ease;
        }
        
        #settingsDropdown button:hover {
            background-color: var(--pmlogin-error-bg);
        }
        
        /* Create Profile tab styles */
        .create-tab-content {
            display: block;
        }
        
        .create-tab-content.hidden {
            display: none;
        }
        
        .create-tab-btn {
            transition: all 0.2s ease;
        }
        
        .create-tab-btn:hover {
            color: var(--pmlogin-gray-700) !important;
        }
        
        .create-tab-btn.active {
            border-bottom: 2px solid var(--pmlogin-secondary);
        }

        /* Pagination styles specific to main page */
        .pagination-wrapper {
            display: flex;
            flex-direction: column;
            gap: 16px;
            padding: 20px;
            background: var(--pmlogin-bg-card);
            border-radius: 12px;
            box-shadow: var(--pmlogin-shadow-default);
        }

        .pagination-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 12px;
        }

        .items-per-page-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: var(--pmlogin-text-secondary);
        }

        .items-per-page-select {
            padding: 6px 12px;
            border: 1px solid var(--pmlogin-border-default);
            border-radius: 6px;
            background: var(--pmlogin-bg-card);
            font-size: 14px;
            color: var(--pmlogin-text-secondary);
            cursor: pointer;
            transition: border-color 0.2s ease;
        }

        .items-per-page-select:hover {
            border-color: var(--pmlogin-border-dark);
        }

        .items-per-page-select:focus {
            outline: none;
            border-color: var(--pmlogin-secondary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .pagination-stats {
            font-size: 14px;
            color: var(--pmlogin-text-muted);
        }

        .pagination-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .pagination-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            border: 1px solid var(--pmlogin-border-default);
            border-radius: 8px;
            background: var(--pmlogin-bg-card);
            color: var(--pmlogin-text-secondary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .pagination-btn:hover:not(:disabled) {
            background: var(--pmlogin-gray-50);
            border-color: var(--pmlogin-border-dark);
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: var(--pmlogin-gray-50);
        }

        .pagination-pages {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .pagination-page {
            min-width: 40px;
            height: 40px;
            padding: 0;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--pmlogin-border-default);
            border-radius: 8px;
            background: var(--pmlogin-bg-card);
            color: var(--pmlogin-text-secondary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            pointer-events: auto;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            position: relative;
            box-sizing: border-box;
        }
        
        .pagination-page * {
            pointer-events: none;
            user-select: none;
        }

        .pagination-page:hover {
            background: var(--pmlogin-gray-50);
            border-color: var(--pmlogin-border-dark);
        }

        .pagination-page.active {
            background: var(--pmlogin-secondary);
            border-color: var(--pmlogin-secondary);
            color: var(--pmlogin-text-white);
        }

        .pagination-ellipsis {
            padding: 0 8px;
            color: var(--pmlogin-text-muted);
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .pagination-wrapper {
                padding: 16px;
            }
            
            .pagination-info {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .pagination-controls {
                flex-direction: column;
                gap: 12px;
            }
            
            .pagination-pages {
                order: -1;
            }
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Load ProfilesStructure and ProfilesView FIRST -->
    <script>
        console.log('üîÑ About to load ProfilesStructure...');
    </script>
    <script src="../../components/profiles_structure.js"></script>
    <script>
        console.log('‚úÖ ProfilesStructure script loaded. Available:', typeof ProfilesStructure !== 'undefined');
        console.log('üîÑ About to load ProfilesView...');
    </script>
    <script src="../profiles/profiles_view.js"></script>
    <script>
        console.log('‚úÖ ProfilesView script loaded. Available:', typeof ProfilesView !== 'undefined');
        console.log('üîç Global classes check:');
        console.log('  - ProfilesStructure:', typeof ProfilesStructure);
        console.log('  - ProfilesView:', typeof ProfilesView);
    </script>
    
    <!-- Notification -->
    <div id="notification" class="notification fixed top-0 left-0 w-full z-50 p-4 text-white text-center font-medium">
        <div id="notificationContent" class="max-w-md mx-auto"></div>
    </div>

    <div class="flex h-screen">
        <!-- Sidebar -->
        <div class="sidebar w-64 text-white">
            <!-- Header -->
            <div class="p-6 border-b border-gray-600">
                <div class="text-center">
                    <div class="flex items-center justify-center space-x-3">
                        <img src="../../assets/logo_on.png" alt="PMLogin Logo" class="w-12 h-12 object-contain">
                        <h1 class="text-2xl font-bold text-white">PMLogin</h1>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="p-4 space-y-2">
                <a href="#" class="sidebar-item active flex items-center space-x-3 p-3 rounded-lg" data-view="dashboard">
                    <i class="fas fa-chart-pie w-5"></i>
                    <span>T·ªïng quan</span>
                </a>
                <a href="#" class="sidebar-item flex items-center space-x-3 p-3 rounded-lg" data-view="create-profile">
                    <i class="fas fa-user-plus w-5"></i>
                    <span>T·∫°o H·ªì S∆°</span>
                </a>
                <a href="#" class="sidebar-item flex items-center space-x-3 p-3 rounded-lg" data-view="profiles">
                    <i class="fas fa-address-book w-5"></i>
                    <span>H·ªì S∆°</span>
                </a>
                <a href="#" class="sidebar-item flex items-center space-x-3 p-3 rounded-lg" data-view="proxies">
                    <i class="fas fa-server w-5"></i>
                    <span>Qu·∫£n l√Ω Proxy</span>
                </a>
                <a href="#" class="sidebar-item flex items-center space-x-3 p-3 rounded-lg" data-view="store">
                    <i class="fas fa-shopping-bag w-5"></i>
                    <span>C·ª≠a H√†ng</span>
                </a>
                <a href="#" class="sidebar-item flex items-center space-x-3 p-3 rounded-lg" data-view="automation">
                    <i class="fas fa-magic w-5"></i>
                    <span>T·ª± ƒê·ªông H√≥a</span>
                </a>
                <a href="#" class="sidebar-item flex items-center space-x-3 p-3 rounded-lg" data-view="account">
                    <i class="fas fa-user-cog w-5"></i>
                    <span>Qu·∫£n l√Ω T√†i Kho·∫£n</span>
                </a>
                <a href="#" class="sidebar-item flex items-center space-x-3 p-3 rounded-lg" data-view="payment">
                    <i class="fas fa-credit-card w-5"></i>
                    <span>Thanh To√°n</span>
                </a>
                <a href="#" class="sidebar-item flex items-center space-x-3 p-3 rounded-lg" data-view="settings">
                    <i class="fas fa-sliders-h w-5"></i>
                    <span>C√†i ƒê·∫∑t</span>
                </a>
                <a href="#" class="sidebar-item flex items-center space-x-3 p-3 rounded-lg" data-view="help">
                    <i class="fas fa-life-ring w-5"></i>
                    <span>Tr·ª£ Gi√∫p & T√†i Li·ªáu</span>
                </a>
            </nav>

            <!-- Footer -->
            <div class="absolute bottom-0 left-0 right-0">
                <!-- User Info -->
                <div class="p-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-green-500 rounded-full flex items-center justify-center font-bold text-white">
                            DU
                        </div>
                        <div>
                            <p class="text-sm font-medium text-white">Demo User</p>
                            <p class="text-xs text-gray-400">PRO PLAN</p>
                        </div>
                        <div class="ml-auto relative">
                            <i id="settingsIcon" class="fas fa-cog text-gray-400 hover:text-white cursor-pointer transition-colors"></i>
                            <!-- Settings Dropdown Menu -->
                            <div id="settingsDropdown" class="absolute bottom-full right-0 mb-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 hidden z-50">
                                <div class="py-2">
                                    <a href="#" class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-view="settings">
                                        <i class="fas fa-sliders-h mr-3 text-gray-400"></i>
                                        C√†i ƒë·∫∑t
                                    </a>
                                    <a href="#" class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-view="account">
                                        <i class="fas fa-user-cog mr-3 text-gray-400"></i>
                                        T√†i kho·∫£n
                                    </a>
                                    <div class="border-t border-gray-200 my-1"></div>
                                    <button id="logoutBtn" class="w-full flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50">
                                        <i class="fas fa-sign-out-alt mr-3 text-red-500"></i>
                                        ƒêƒÉng xu·∫•t
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="content-area flex-1 overflow-y-auto">
            <!-- Dashboard View -->
            <div id="dashboardView" class="view-content p-6">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">T·ªïng quan h·ªá th·ªëng</h2>
                    <p class="text-gray-600">Ch√†o m·ª´ng b·∫°n quay tr·ªü l·∫°i v·ªõi PMLogin Dashboard</p>
                </div>

                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="stat-card green card p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-green-100 text-sm">T·ªïng Proxy</p>
                                <p class="text-2xl font-bold" id="totalProxies">3</p>
                            </div>
                            <i class="fas fa-globe text-2xl text-green-200"></i>
                        </div>
                    </div>
                    
                    <div class="stat-card blue card p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-blue-100 text-sm">Proxy ho·∫°t ƒë·ªông</p>
                                <p class="text-2xl font-bold" id="workingProxies">2</p>
                            </div>
                            <i class="fas fa-check-circle text-2xl text-blue-200"></i>
                        </div>
                    </div>
                    
                    <div class="stat-card orange card p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-orange-100 text-sm">Profiles</p>
                                <p class="text-2xl font-bold" id="totalProfiles">5</p>
                            </div>
                            <i class="fas fa-users text-2xl text-orange-200"></i>
                        </div>
                    </div>
                    
                    <div class="stat-card card p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-purple-100 text-sm">Phi√™n b·∫£n</p>
                                <p class="text-lg font-bold" id="appVersionDashboard">1.0.0</p>
                            </div>
                            <i class="fas fa-code-branch text-2xl text-purple-200"></i>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="card p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Ho·∫°t ƒë·ªông g·∫ßn ƒë√¢y</h3>
                    <div id="recentActivity" class="space-y-3">
                        <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded-lg">
                            <i class="fas fa-info-circle text-blue-500"></i>
                            <span class="text-gray-700">H·ªá th·ªëng ƒë√£ chuy·ªÉn sang s·ª≠ d·ª•ng Python backend ƒë·ªÉ x·ª≠ l√Ω proxy v√† profiles!</span>
                        </div>
                        <div class="flex items-center space-x-3 p-3 bg-green-50 rounded-lg">
                            <i class="fas fa-check-circle text-green-500"></i>
                            <span class="text-gray-700">ƒê√£ lo·∫°i b·ªè sample data - t·∫•t c·∫£ d·ªØ li·ªáu ƒë·ªÅu t·ª´ database th·ª±c.</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Proxies View -->
            <div id="proxiesView" class="view-content p-6 hidden">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">Qu·∫£n l√Ω Proxy</h2>
                        <p class="text-gray-600">Th√™m, s·ª≠a, x√≥a v√† test proxy</p>
                    </div>
                    <div class="space-x-2">
                        <button id="addProxyBtn" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors">
                            <i class="fas fa-plus mr-2"></i>Th√™m Proxy
                        </button>
                        <button id="importProxyBtn" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                            <i class="fas fa-upload mr-2"></i>Import
                        </button>
                        <button id="testSelectedProxiesBtn" class="bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600 transition-colors" disabled>
                            <i class="fas fa-check-circle mr-2"></i>Test Selected
                        </button>
                        <button id="deleteSelectedProxiesBtn" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors" disabled>
                            <i class="fas fa-trash mr-2"></i>Delete Selected
                        </button>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div class="bg-white rounded-lg shadow-sm p-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-600">Total Proxies</p>
                                <p class="text-2xl font-bold text-gray-800" id="totalProxiesCount">0</p>
                            </div>
                            <i class="fas fa-server text-2xl text-blue-500"></i>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-sm p-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-600">Live Proxies</p>
                                <p class="text-2xl font-bold text-green-600" id="liveProxiesCount">0</p>
                            </div>
                            <i class="fas fa-check-circle text-2xl text-green-500"></i>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-sm p-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-600">Dead Proxies</p>
                                <p class="text-2xl font-bold text-red-600" id="deadProxiesCount">0</p>
                            </div>
                            <i class="fas fa-times-circle text-2xl text-red-500"></i>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-sm p-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-600">Unchecked</p>
                                <p class="text-2xl font-bold text-gray-600" id="uncheckedProxiesCount">0</p>
                            </div>
                            <i class="fas fa-question-circle text-2xl text-gray-500"></i>
                        </div>
                    </div>
                </div>

                <!-- Filters -->
                <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
                    <div class="flex flex-wrap items-end gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Filter by Status</label>
                            <select id="proxyStatusFilter" class="border border-gray-300 rounded-lg px-3 py-2">
                                <option value="">All Status</option>
                                <option value="live">Live</option>
                                <option value="dead">Dead</option>
                                <option value="unchecked">Unchecked</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Filter by Type</label>
                            <select id="proxyTypeFilter" class="border border-gray-300 rounded-lg px-3 py-2">
                                <option value="">All Types</option>
                                <option value="http">HTTP</option>
                                <option value="https">HTTPS</option>
                                <option value="socks4">SOCKS4</option>
                                <option value="socks5">SOCKS5</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Filter by Tag</label>
                            <select id="proxyTagFilter" class="border border-gray-300 rounded-lg px-3 py-2">
                                <option value="">All Tags</option>
                            </select>
                        </div>
                        <div class="flex-1">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Search</label>
                            <input type="text" id="proxySearchInput" class="w-full border border-gray-300 rounded-lg px-3 py-2" placeholder="Search by host, port, or name...">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 invisible">Clear</label>
                            <button id="clearFiltersBtn" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                                <i class="fas fa-times mr-2"></i>Clear
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Proxy Table -->
                <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left">
                                        <input type="checkbox" id="selectAllProxies" class="rounded">
                                    </th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Name</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Host:Port</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Type</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Auth</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Status</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Tags</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Last Used</th>
                                    <th class="px-4 py-3 text-left text-sm font-medium text-gray-700">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="proxyTableBody" class="divide-y divide-gray-200">
                                <!-- Proxy rows will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Empty State -->
                    <div id="proxyEmptyState" class="text-center py-12 hidden">
                        <i class="fas fa-server text-4xl text-gray-400 mb-4"></i>
                        <h3 class="text-lg font-medium text-gray-900 mb-2">No proxies found</h3>
                        <p class="text-gray-500 mb-4">Get started by adding your first proxy</p>
                        <button class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors" onclick="document.getElementById('addProxyBtn').click()">
                            <i class="fas fa-plus mr-2"></i>Add Proxy
                        </button>
                    </div>

                    <!-- Loading State -->
                    <div id="proxyLoadingState" class="text-center py-12 hidden">
                        <i class="fas fa-spinner fa-spin text-4xl text-gray-400 mb-4"></i>
                        <h3 class="text-lg font-medium text-gray-900 mb-2">Loading proxies...</h3>
                    </div>
                </div>

                <!-- Enhanced Pagination -->
                <div id="proxyPaginationContainer" class="pagination-wrapper mt-6">
                    <div class="pagination-info">
                        <div class="items-per-page-selector">
                            <label for="proxyItemsPerPage">Hi·ªÉn th·ªã:</label>
                            <select id="proxyItemsPerPage" class="items-per-page-select">
                                <option value="5">5</option>
                                <option value="10" selected>10</option>
                                <option value="25">25</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                            </select>
                            <span>proxies/trang</span>
                        </div>
                        
                        <div class="pagination-stats">
                            <span>Hi·ªÉn th·ªã <span id="proxyShowingStart">0</span> - <span id="proxyShowingEnd">0</span> c·ªßa <span id="proxyTotalCount">0</span> proxies</span>
                        </div>
                    </div>
                    
                    <div class="pagination-controls">
                        <button id="proxyPrevPage" class="pagination-btn pagination-btn-prev" disabled>
                            <i class="fas fa-chevron-left"></i>
                            <span>Tr∆∞·ªõc</span>
                        </button>
                        
                        <div id="proxyPaginationPages" class="pagination-pages">
                            <!-- Page numbers will be generated here -->
                        </div>
                        
                        <button id="proxyNextPage" class="pagination-btn pagination-btn-next" disabled>
                            <span>Sau</span>
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Profiles View - Using ProfilesView -->
            <div id="profilesView" class="view-content hidden">
                <!-- ProfilesView will replace this content -->
                <div class="flex items-center justify-center h-64">
                    <div class="text-center">
                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"></div>
                        <p class="text-gray-600">Loading profiles...</p>
                    </div>
                </div>
            </div>

            <!-- Create Profile View -->
            <div id="createProfileView" class="view-content p-6 hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">T·∫°o H·ªì S∆°</h2>
                    <p class="text-gray-600">T·∫°o h·ªì s∆° browser m·ªõi v·ªõi c·∫•u h√¨nh t√πy ch·ªânh</p>
                </div>

                <!-- Create Profile Form -->
                <div class="bg-white rounded-lg shadow-sm p-6">
                    <!-- Tab Navigation -->
                    <div class="flex border-b border-gray-200 mb-6">
                        <button class="create-tab-btn active px-6 py-3 text-sm font-medium text-blue-600 border-b-2 border-blue-600" data-tab="general">
                            <i class="fas fa-info-circle mr-2"></i>Th√¥ng tin chung
                        </button>
                        <button class="create-tab-btn px-6 py-3 text-sm font-medium text-gray-500 hover:text-gray-700" data-tab="proxy">
                            <i class="fas fa-server mr-2"></i>Proxy
                        </button>
                        <button class="create-tab-btn px-6 py-3 text-sm font-medium text-gray-500 hover:text-gray-700" data-tab="browser">
                            <i class="fas fa-globe mr-2"></i>Browser
                        </button>
                        <button class="create-tab-btn px-6 py-3 text-sm font-medium text-gray-500 hover:text-gray-700" data-tab="advanced">
                            <i class="fas fa-sliders-h mr-2"></i>N√¢ng cao
                        </button>
                    </div>

                    <!-- Tab Contents -->
                    <div>
                        <!-- General Tab -->
                        <div id="generalCreateTab" class="create-tab-content">
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <!-- Basic Info -->
                                <div class="space-y-4">
                                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Th√¥ng tin c∆° b·∫£n</h3>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">T√™n Profile *</label>
                                        <input type="text" id="createProfileName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Nh·∫≠p t√™n profile">
                                    </div>

                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Platform</label>
                                        <select id="createPlatformSelect" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="windows">Windows</option>
                                            <option value="macos">macOS</option>
                                            <option value="linux">Linux</option>
                                        </select>
                                    </div>

                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Browser</label>
                                        <select id="createBrowserSelect" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="chrome">Google Chrome</option>
                                            <option value="firefox">Mozilla Firefox</option>
                                            <option value="edge">Microsoft Edge</option>
                                            <option value="safari">Safari</option>
                                        </select>
                                    </div>

                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Tags</label>
                                        <input type="text" id="createProfileTags" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="work, social, test (ph√¢n c√°ch b·∫±ng d·∫•u ph·∫©y)">
                                    </div>
                                </div>

                                <!-- Group & Settings -->
                                <div class="space-y-4">
                                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Nh√≥m & C√†i ƒë·∫∑t</h3>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Nh√≥m</label>
                                        <select id="createGroupSelect" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="">Kh√¥ng c√≥ nh√≥m</option>
                                            <option value="work">Work</option>
                                            <option value="personal">Personal</option>
                                            <option value="test">Test</option>
                                        </select>
                                    </div>

                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Ghi ch√∫</label>
                                        <textarea id="createProfileNote" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Ghi ch√∫ v·ªÅ profile n√†y..."></textarea>
                                    </div>

                                    <div class="space-y-3">
                                        <div class="flex items-center">
                                            <input type="checkbox" id="createShareOnCloud" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                            <label for="createShareOnCloud" class="ml-2 text-sm text-gray-700">Chia s·∫ª tr√™n Cloud</label>
                                        </div>
                                        <div class="flex items-center">
                                            <input type="checkbox" id="createAutoStart" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                            <label for="createAutoStart" class="ml-2 text-sm text-gray-700">T·ª± ƒë·ªông kh·ªüi ƒë·ªông</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Proxy Tab -->
                        <div id="proxyCreateTab" class="create-tab-content hidden">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">C·∫•u h√¨nh Proxy</h3>
                            
                            <!-- Proxy Type Selection -->
                            <div class="mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-3">Lo·∫°i Proxy</label>
                                <div class="space-y-2">
                                    <div class="flex items-center">
                                        <input type="radio" id="createNoProxy" name="createProxyType" value="none" class="h-4 w-4 text-blue-600 focus:ring-blue-500" checked>
                                        <label for="createNoProxy" class="ml-2 text-sm text-gray-700">Kh√¥ng s·ª≠ d·ª•ng proxy</label>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="radio" id="createPmProxy" name="createProxyType" value="pm_proxy" class="h-4 w-4 text-blue-600 focus:ring-blue-500">
                                        <label for="createPmProxy" class="ml-2 text-sm text-gray-700">PM Proxy (t·ª´ h·ªá th·ªëng)</label>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="radio" id="createCustomProxy" name="createProxyType" value="custom" class="h-4 w-4 text-blue-600 focus:ring-blue-500">
                                        <label for="createCustomProxy" class="ml-2 text-sm text-gray-700">Proxy t√πy ch·ªânh</label>
                                    </div>
                                </div>
                            </div>

                            <!-- PM Proxy Section -->
                            <div id="createPmProxySection" class="hidden mb-6">
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Ch·ªçn PM Proxy</label>
                                    <select id="createPmProxySelect" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <option value="">Ch·ªçn proxy...</option>
                                        <option value="proxy1">Proxy 1 (US) - 192.168.1.1:8080</option>
                                        <option value="proxy2">Proxy 2 (UK) - 192.168.1.2:8080</option>
                                        <option value="proxy3">Proxy 3 (JP) - 192.168.1.3:8080</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Custom Proxy Section -->
                            <div id="createCustomProxySection" class="hidden">
                                <div class="bg-gray-50 p-4 rounded-lg space-y-4">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Lo·∫°i Proxy</label>
                                            <select id="createProxyProtocol" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                                <option value="http">HTTP</option>
                                                <option value="https">HTTPS</option>
                                                <option value="socks4">SOCKS4</option>
                                                <option value="socks5">SOCKS5</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Host *</label>
                                            <input type="text" id="createProxyHost" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="192.168.1.1">
                                        </div>
                                    </div>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Port *</label>
                                            <input type="number" id="createProxyPort" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="8080">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                                            <input type="text" id="createProxyUsername" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="username">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                                            <input type="password" id="createProxyPassword" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="password">
                                        </div>
                                    </div>
                                    
                                    <div class="flex space-x-2">
                                        <button id="createTestProxyBtn" class="btn btn-secondary btn-md">
                                            <i class="fas fa-check-circle"></i>
                                            <span>Test Proxy</span>
                                        </button>
                                        <button id="createClearProxyBtn" class="btn btn-outline btn-md">
                                            <i class="fas fa-eraser"></i>
                                            <span>Clear</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Browser Tab -->
                        <div id="browserCreateTab" class="create-tab-content hidden">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">C√†i ƒë·∫∑t Browser</h3>
                            
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <!-- User Agent -->
                                <div class="space-y-4">
                                    <h4 class="font-medium text-gray-800">User Agent</h4>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">User Agent String</label>
                                        <textarea id="createUserAgent" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36..."></textarea>
                                    </div>
                                    <button id="createGenerateUserAgent" class="btn btn-secondary btn-md">
                                        <i class="fas fa-dice"></i>
                                        <span>Generate Random</span>
                                    </button>
                                </div>

                                <!-- Screen Resolution -->
                                <div class="space-y-4">
                                    <h4 class="font-medium text-gray-800">Screen Resolution</h4>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Width</label>
                                            <input type="number" id="createScreenWidth" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" value="1920">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Height</label>
                                            <input type="number" id="createScreenHeight" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" value="1080">
                                        </div>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="checkbox" id="createRandomResolution" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label for="createRandomResolution" class="ml-2 text-sm text-gray-700">Random resolution</label>
                                    </div>
                                </div>
                            </div>

                            <!-- WebRTC -->
                            <div class="mt-6">
                                <h4 class="font-medium text-gray-800 mb-4">WebRTC</h4>
                                <select id="createWebrtcSelect" class="w-full max-w-md p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="disabled">Disabled</option>
                                    <option value="fake">Fake</option>
                                    <option value="real">Real</option>
                                </select>
                            </div>
                        </div>

                        <!-- Advanced Tab -->
                        <div id="advancedCreateTab" class="create-tab-content hidden">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">C√†i ƒë·∫∑t n√¢ng cao</h3>
                            
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <!-- Location -->
                                <div class="space-y-4">
                                    <h4 class="font-medium text-gray-800">Location & Timezone</h4>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Timezone</label>
                                        <select id="createTimezoneSelect" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="auto">Auto detect</option>
                                            <option value="Asia/Ho_Chi_Minh">Asia/Ho_Chi_Minh</option>
                                            <option value="America/New_York">America/New_York</option>
                                            <option value="Europe/London">Europe/London</option>
                                            <option value="Asia/Tokyo">Asia/Tokyo</option>
                                        </select>
                                    </div>

                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Geolocation</label>
                                        <select id="createGeolocationSelect" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="auto">Auto (from proxy)</option>
                                            <option value="disabled">Disabled</option>
                                            <option value="custom">Custom</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Cookies -->
                                <div class="space-y-4">
                                    <h4 class="font-medium text-gray-800">Cookies</h4>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Import Cookies</label>
                                        <textarea id="createCookiesTextarea" rows="6" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Paste cookies here (JSON format)..."></textarea>
                                    </div>
                                    
                                    <div class="flex space-x-2">
                                        <button id="createImportCookiesBtn" class="btn btn-secondary btn-md">
                                            <i class="fas fa-file-import"></i>
                                            <span>Import from File</span>
                                        </button>
                                        <button id="createClearCookiesBtn" class="btn btn-outline btn-md">
                                            <i class="fas fa-broom"></i>
                                            <span>Clear</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex justify-end space-x-3 mt-6 pt-6 border-t border-gray-200">
                        <button id="createCancelBtn" class="btn btn-outline btn-lg">
                            <i class="fas fa-times-circle"></i>
                            <span>H·ªßy</span>
                        </button>
                        <button id="createSaveProfileBtn" class="btn btn-primary btn-lg">
                            <i class="fas fa-plus-circle"></i>
                            <span>T·∫°o Profile</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Store View -->
            <div id="storeView" class="view-content p-6 hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">C·ª≠a H√†ng</h2>
                    <p class="text-gray-600">Mua proxy, extension v√† c√°c d·ªãch v·ª• kh√°c</p>
                </div>

                <div class="card p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Store (Coming Soon)</h3>
                    <p class="text-gray-600">Store functionality will be implemented here.</p>
                </div>
            </div>

            <!-- Automation View -->
            <div id="automationView" class="view-content p-6 hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">T·ª± ƒê·ªông H√≥a</h2>
                    <p class="text-gray-600">T·∫°o v√† qu·∫£n l√Ω c√°c script t·ª± ƒë·ªông</p>
                </div>

                <div class="card p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Automation (Coming Soon)</h3>
                    <p class="text-gray-600">Automation functionality will be implemented here.</p>
                </div>
            </div>

            <!-- Account Management View -->
            <div id="accountView" class="view-content p-6 hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Qu·∫£n l√Ω T√†i Kho·∫£n</h2>
                    <p class="text-gray-600">Qu·∫£n l√Ω th√¥ng tin t√†i kho·∫£n v√† team</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Account Info -->
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Th√¥ng tin t√†i kho·∫£n</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                                <input type="email" class="w-full p-3 border border-gray-300 rounded-lg bg-gray-50" value="demo@pmlogin.com" readonly>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">G√≥i d·ªãch v·ª•</label>
                                <input type="text" class="w-full p-3 border border-gray-300 rounded-lg bg-gray-50" value="PRO PLAN" readonly>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Ng√†y h·∫øt h·∫°n</label>
                                <input type="text" class="w-full p-3 border border-gray-300 rounded-lg bg-gray-50" value="31/12/2024" readonly>
                            </div>
                        </div>
                    </div>

                    <!-- Team Management -->
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Qu·∫£n l√Ω Team</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">Th√†nh vi√™n:</span>
                                <span class="font-medium">1/5</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">Profiles:</span>
                                <span class="font-medium">5/100</span>
                            </div>
                            <button class="w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors">
                                M·ªùi th√†nh vi√™n
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Payment View -->
            <div id="paymentView" class="view-content p-6 hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Thanh To√°n</h2>
                    <p class="text-gray-600">L·ªãch s·ª≠ thanh to√°n v√† gia h·∫°n d·ªãch v·ª•</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Current Plan -->
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">G√≥i hi·ªán t·∫°i</h3>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-green-600 mb-2">PRO PLAN</div>
                            <div class="text-gray-600 mb-4">100 Profiles ‚Ä¢ Team 5 ng∆∞·ªùi</div>
                            <div class="text-sm text-gray-500 mb-4">H·∫øt h·∫°n: 31/12/2024</div>
                            <button class="w-full bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 transition-colors">
                                Gia h·∫°n
                            </button>
                        </div>
                    </div>

                    <!-- Payment History -->
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">L·ªãch s·ª≠ thanh to√°n</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <div>
                                    <div class="font-medium">PRO PLAN - 1 th√°ng</div>
                                    <div class="text-sm text-gray-500">01/12/2024</div>
                                </div>
                                <div class="text-green-600 font-medium">$29.99</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Help View -->
            <div id="helpView" class="view-content p-6 hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Tr·ª£ Gi√∫p & T√†i Li·ªáu</h2>
                    <p class="text-gray-600">H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng v√† h·ªó tr·ª£ k·ªπ thu·∫≠t</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Quick Links -->
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Li√™n k·∫øt nhanh</h3>
                        <div class="space-y-3">
                            <a href="#" class="flex items-center space-x-3 p-3 hover:bg-gray-50 rounded-lg transition-colors">
                                <i class="fas fa-book text-blue-500"></i>
                                <span>H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</span>
                            </a>
                            <a href="#" class="flex items-center space-x-3 p-3 hover:bg-gray-50 rounded-lg transition-colors">
                                <i class="fas fa-video text-red-500"></i>
                                <span>Video tutorials</span>
                            </a>
                            <a href="#" class="flex items-center space-x-3 p-3 hover:bg-gray-50 rounded-lg transition-colors">
                                <i class="fas fa-comments text-green-500"></i>
                                <span>Community Forum</span>
                            </a>
                            <a href="#" class="flex items-center space-x-3 p-3 hover:bg-gray-50 rounded-lg transition-colors">
                                <i class="fas fa-headset text-purple-500"></i>
                                <span>H·ªó tr·ª£ tr·ª±c tuy·∫øn</span>
                            </a>
                        </div>
                    </div>

                    <!-- Contact Support -->
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Li√™n h·ªá h·ªó tr·ª£</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Ch·ªß ƒë·ªÅ</label>
                                <select class="w-full p-3 border border-gray-300 rounded-lg">
                                    <option>V·∫•n ƒë·ªÅ k·ªπ thu·∫≠t</option>
                                    <option>Thanh to√°n</option>
                                    <option>T√†i kho·∫£n</option>
                                    <option>Kh√°c</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Tin nh·∫Øn</label>
                                <textarea class="w-full p-3 border border-gray-300 rounded-lg h-24" placeholder="M√¥ t·∫£ v·∫•n ƒë·ªÅ c·ªßa b·∫°n..."></textarea>
                            </div>
                            <button class="w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors">
                                G·ª≠i y√™u c·∫ßu h·ªó tr·ª£
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings View -->
            <div id="settingsView" class="view-content p-6 hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">C√†i ƒê·∫∑t</h2>
                    <p class="text-gray-600">C·∫•u h√¨nh ·ª©ng d·ª•ng v√† t√πy ch·ªânh</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- General Settings -->
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">C√†i ƒë·∫∑t chung</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-sm font-medium text-gray-700">Kh·ªüi ƒë·ªông c√πng Windows</label>
                                    <p class="text-xs text-gray-500">T·ª± ƒë·ªông m·ªü ·ª©ng d·ª•ng khi kh·ªüi ƒë·ªông m√°y</p>
                                </div>
                                <input type="checkbox" class="toggle-switch">
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-sm font-medium text-gray-700">Minimize to tray</label>
                                    <p class="text-xs text-gray-500">Thu nh·ªè xu·ªëng system tray</p>
                                </div>
                                <input type="checkbox" class="toggle-switch" checked>
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-sm font-medium text-gray-700">Th√¥ng b√°o</label>
                                    <p class="text-xs text-gray-500">Hi·ªÉn th·ªã th√¥ng b√°o h·ªá th·ªëng</p>
                                </div>
                                <input type="checkbox" class="toggle-switch" checked>
                            </div>
                        </div>
                    </div>

                    <!-- System Info -->
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Th√¥ng tin h·ªá th·ªëng</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Phi√™n b·∫£n:</span>
                                <span id="systemVersion" class="font-medium">1.0.0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Platform:</span>
                                <span id="systemPlatform" class="font-medium">Windows</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Hardware ID:</span>
                                <span id="systemHwid" class="font-medium font-mono text-sm">DEMO-HWID-123</span>
                            </div>
                            <button id="checkUpdatesBtn" class="w-full bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 transition-colors">
                                Ki·ªÉm tra c·∫≠p nh·∫≠t
                            </button>
                        </div>
                    </div>

                    <!-- Browser Settings -->
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">C√†i ƒë·∫∑t Browser</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Chrome Path</label>
                                <div class="flex space-x-2">
                                    <input type="text" class="flex-1 p-3 border border-gray-300 rounded-lg bg-gray-50" value="C:\Program Files\Google\Chrome\Application\chrome.exe" readonly>
                                    <button class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                                        Browse
                                    </button>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">User Data Folder</label>
                                <div class="flex space-x-2">
                                    <input type="text" class="flex-1 p-3 border border-gray-300 rounded-lg bg-gray-50" value="C:\PMLogin\UserData" readonly>
                                    <button class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                                        Browse
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Settings -->
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">C√†i ƒë·∫∑t n√¢ng cao</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Proxy Timeout (seconds)</label>
                                <input type="number" class="w-full p-3 border border-gray-300 rounded-lg" value="30">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Max Concurrent Profiles</label>
                                <input type="number" class="w-full p-3 border border-gray-300 rounded-lg" value="10">
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <label class="text-sm font-medium text-gray-700">Debug Mode</label>
                                    <p class="text-xs text-gray-500">Hi·ªÉn th·ªã th√¥ng tin debug</p>
                                </div>
                                <input type="checkbox" class="toggle-switch">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Proxy Modal -->
    <div id="addProxyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full">
                <div class="flex items-center justify-between p-6 border-b">
                    <h3 class="text-lg font-semibold text-gray-900">Add New Proxy</h3>
                    <button id="closeAddProxyModal" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="p-6">
                    <form id="addProxyForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Name (Optional)</label>
                            <input type="text" id="proxyName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="My Proxy">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Host *</label>
                                <input type="text" id="proxyHost" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="192.168.1.1" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Port *</label>
                                <input type="number" id="proxyPort" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="8080" required>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Type</label>
                            <select id="proxyType" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="http">HTTP</option>
                                <option value="https">HTTPS</option>
                                <option value="socks4">SOCKS4</option>
                                <option value="socks5">SOCKS5</option>
                            </select>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                                <input type="text" id="proxyUsername" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="username">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                                <input type="password" id="proxyPassword" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="password">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tags</label>
                            <input type="text" id="proxyTags" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="residential, premium (comma separated)">
                        </div>
                    </form>
                </div>
                <div class="flex justify-end space-x-3 p-6 border-t">
                    <button id="cancelAddProxy" class="px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50">
                        Cancel
                    </button>
                    <button id="testAddProxy" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">
                        Test & Add
                    </button>
                    <button id="saveAddProxy" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">
                        Add Proxy
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Import Proxy Modal -->
    <div id="importProxyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full">
                <div class="flex items-center justify-between p-6 border-b">
                    <h3 class="text-lg font-semibold text-gray-900">Import Proxies</h3>
                    <button id="closeImportProxyModal" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="p-6">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Import Format</label>
                        <select id="importFormat" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="host:port">host:port</option>
                            <option value="host:port:username:password">host:port:username:password</option>
                            <option value="type://host:port">type://host:port</option>
                            <option value="type://host:port:username:password">type://host:port:username:password</option>
                            <option value="type://username:password@host:port">type://username:password@host:port</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Default Tags (Optional)</label>
                        <input type="text" id="importTags" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="imported, batch1 (comma separated)">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Proxy List</label>
                        <textarea id="importProxyText" rows="10" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Paste your proxy list here, one per line..."></textarea>
                    </div>
                    <div class="text-sm text-gray-600">
                        <p class="mb-2"><strong>Examples:</strong></p>
                        <ul class="list-disc list-inside space-y-1">
                            <li>192.168.1.1:8080</li>
                            <li>192.168.1.1:8080:username:password</li>
                            <li>http://192.168.1.1:8080</li>
                            <li>socks5://username:password@192.168.1.1:1080</li>
                        </ul>
                    </div>
                </div>
                <div class="flex justify-between items-center p-6 border-t">
                    <div class="text-sm text-gray-600">
                        <span id="importPreviewCount">0</span> proxies detected
                    </div>
                    <div class="flex space-x-3">
                        <button id="cancelImportProxy" class="px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button id="previewImportProxy" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                            Preview
                        </button>
                        <button id="saveImportProxy" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600" disabled>
                            Import Proxies
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Proxy Modal -->
    <div id="editProxyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full">
                <div class="flex items-center justify-between p-6 border-b">
                    <h3 class="text-lg font-semibold text-gray-900">Edit Proxy</h3>
                    <button id="closeEditProxyModal" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="p-6">
                    <form id="editProxyForm" class="space-y-4">
                        <input type="hidden" id="editProxyId">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Name (Optional)</label>
                            <input type="text" id="editProxyName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="My Proxy">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Host *</label>
                                <input type="text" id="editProxyHost" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="192.168.1.1" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Port *</label>
                                <input type="number" id="editProxyPort" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="8080" required>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Type</label>
                            <select id="editProxyType" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="http">HTTP</option>
                                <option value="https">HTTPS</option>
                                <option value="socks4">SOCKS4</option>
                                <option value="socks5">SOCKS5</option>
                            </select>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                                <input type="text" id="editProxyUsername" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="username">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                                <input type="password" id="editProxyPassword" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="password">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tags</label>
                            <input type="text" id="editProxyTags" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="residential, premium (comma separated)">
                        </div>
                    </form>
                </div>
                <div class="flex justify-end space-x-3 p-6 border-t">
                    <button id="cancelEditProxy" class="px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50">
                        Cancel
                    </button>
                    <button id="testEditProxy" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">
                        Test
                    </button>
                    <button id="saveEditProxy" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                        Update Proxy
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../../components/profiles_structure.js"></script>
    <script src="../profiles/profiles_view.js"></script>
    <script>
        // Global variables
        let profilesStructure = null;
        let currentTab = 'local';

        // Sample data removed - now using ProfilesView to load from database

        // Main initialization - now using ProfilesView instead of ProfilesStructure
        function initializeProfiles() {
            console.log('Initializing profiles with ProfilesView...');
            
            try {
                // Check if ProfilesView is available
                if (typeof ProfilesView === 'undefined') {
                    console.error('ProfilesView class not found!');
                    return;
                }

                // Get profiles container
                const profilesContainer = document.getElementById('profilesView');
                if (!profilesContainer) {
                    console.error('Profiles container not found!');
                    return;
                }

                // Destroy existing instance if any
                if (window.profilesViewInstance && window.profilesViewInstance.destroy) {
                    console.log('Destroying existing ProfilesView instance...');
                    window.profilesViewInstance.destroy();
                }

                // Create new ProfilesView instance
                console.log('Creating ProfilesView instance...');
                window.profilesViewInstance = new ProfilesView(profilesContainer);

                console.log('ProfilesView initialization completed');

            } catch (error) {
                console.error('Error initializing ProfilesView:', error.message);
            }
        }

        // Tab switching for Create Profile
        function switchCreateTab(tabName) {
            // Remove active class from all create tab buttons
            const createTabButtons = document.querySelectorAll('.create-tab-btn');
            createTabButtons.forEach(btn => {
                btn.classList.remove('active', 'text-blue-600', 'border-blue-600');
                btn.classList.add('text-gray-500');
            });
            
            // Hide all create tab contents
            const createTabContents = document.querySelectorAll('.create-tab-content');
            createTabContents.forEach(content => content.classList.add('hidden'));
            
            // Add active class to selected tab button
            const activeButton = document.querySelector(`[data-tab="${tabName}"]`);
            if (activeButton && activeButton.classList.contains('create-tab-btn')) {
                activeButton.classList.remove('text-gray-500');
                activeButton.classList.add('active', 'text-blue-600', 'border-blue-600');
            }
            
            // Show selected tab content
            const activeContent = document.getElementById(`${tabName}CreateTab`);
            if (activeContent) {
                activeContent.classList.remove('hidden');
            }
        }

        // Handle Create Profile proxy type change
        function handleCreateProxyTypeChange(proxyType) {
            const pmProxySection = document.getElementById('createPmProxySection');
            const customProxySection = document.getElementById('createCustomProxySection');
            
            // Hide all sections
            if (pmProxySection) pmProxySection.classList.add('hidden');
            if (customProxySection) customProxySection.classList.add('hidden');
            
            // Show relevant section
            switch (proxyType) {
                case 'pm_proxy':
                    if (pmProxySection) pmProxySection.classList.remove('hidden');
                    break;
                case 'custom':
                    if (customProxySection) customProxySection.classList.remove('hidden');
                    break;
            }
        }

        // Handle Create Profile form submission
        function handleCreateProfile() {
            const profileName = document.getElementById('createProfileName')?.value;
            
            if (!profileName || !profileName.trim()) {
                alert('Vui l√≤ng nh·∫≠p t√™n profile');
                return;
            }
            
            // Collect form data
            const formData = {
                name: profileName.trim(),
                platform: document.getElementById('createPlatformSelect')?.value || 'windows',
                browser: document.getElementById('createBrowserSelect')?.value || 'chrome',
                tags: document.getElementById('createProfileTags')?.value || '',
                group: document.getElementById('createGroupSelect')?.value || '',
                note: document.getElementById('createProfileNote')?.value || '',
                shareOnCloud: document.getElementById('createShareOnCloud')?.checked || false,
                autoStart: document.getElementById('createAutoStart')?.checked || false,
                // Add proxy data, browser settings, etc.
            };
            
            console.log('Creating profile:', formData);
            
            // Show success message
            alert('Profile ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng!');
            
            // Clear form
            clearCreateProfileForm();
            
            // Go back to profiles view
            switchView('profiles');
        }

        // Update dashboard statistics t·ª´ Python backend
        async function updateDashboardStats() {
            try {
                console.log('üîÑ Updating dashboard statistics from Python backend...');
                
                // Update profiles count
                if (window.electronAPI && window.electronAPI.invoke) {
                    try {
                        const profilesResponse = await window.electronAPI.invoke('python-local:get-profiles');
                        if (profilesResponse && profilesResponse.success) {
                            const totalProfilesEl = document.getElementById('totalProfiles');
                            if (totalProfilesEl) {
                                totalProfilesEl.textContent = profilesResponse.data.length;
                            }
                            console.log(`‚úÖ Updated profiles count: ${profilesResponse.data.length}`);
                        }
                    } catch (profileError) {
                        console.log('‚ÑπÔ∏è Profile service not available, keeping default values');
                    }
                    
                    // Update proxy counts
                    try {
                        const proxiesResponse = await window.electronAPI.invoke('python-local:get-proxies');
                        if (proxiesResponse && proxiesResponse.success) {
                            const totalProxiesEl = document.getElementById('totalProxies');
                            const workingProxiesEl = document.getElementById('workingProxies');
                            
                            if (totalProxiesEl) {
                                totalProxiesEl.textContent = proxiesResponse.data.length;
                            }
                            
                            // Count working proxies
                            const workingCount = proxiesResponse.data.filter(proxy => 
                                proxy.status === 'live' || proxy.status === 'working'
                            ).length;
                            
                            if (workingProxiesEl) {
                                workingProxiesEl.textContent = workingCount;
                            }
                            
                            console.log(`‚úÖ Updated proxy counts: Total(${proxiesResponse.data.length}), Working(${workingCount})`);
                        }
                    } catch (proxyError) {
                        console.log('‚ÑπÔ∏è Proxy service not available, keeping default values');
                    }
                } else {
                    console.warn('‚ö†Ô∏è electronAPI not available, keeping default dashboard values');
                }
            } catch (error) {
                console.error('‚ùå Error updating dashboard stats:', error);
            }
        }

        // Initialize Create Profile functionality
        function initializeCreateProfile() {
            console.log('Initializing Create Profile...');
            
            // Set default tab
            switchCreateTab('general');
            
            // Set default proxy type
            handleCreateProxyTypeChange('none');
            
            console.log('Create Profile initialized');
        }
        function clearCreateProfileForm() {
            document.getElementById('createProfileName').value = '';
            document.getElementById('createProfileTags').value = '';
            document.getElementById('createProfileNote').value = '';
            document.getElementById('createShareOnCloud').checked = false;
            document.getElementById('createAutoStart').checked = false;
            
            // Reset to first tab
            switchCreateTab('general');
            
            // Reset proxy type
            document.getElementById('createNoProxy').checked = true;
            handleCreateProxyTypeChange('none');
        }
        function switchTab(tab) {
            debugLog(`üîÑ Switching to tab: ${tab}`, 'info');
            
            currentTab = tab;
            
            // Update tab buttons
            const tabButtons = document.querySelectorAll('.tab-btn');
            tabButtons.forEach(btn => {
                btn.classList.remove('active', 'bg-green-100', 'text-green-700');
                btn.classList.add('text-gray-600', 'hover:bg-gray-100');
            });
            
            const activeTab = document.querySelector(`[data-tab="${tab}"]`);
            if (activeTab) {
                activeTab.classList.remove('text-gray-600', 'hover:bg-gray-100');
                activeTab.classList.add('active', 'bg-green-100', 'text-green-700');
            }
            
            // Reinitialize profiles for new tab
            initializeProfiles();
        }

        // View switching
        function switchView(viewName) {
            console.log(`Switching to view: ${viewName}`);
            
            // Hide all views
            const views = document.querySelectorAll('.view-content');
            views.forEach(view => view.classList.add('hidden'));
            
            // Convert kebab-case to camelCase for view ID
            let viewId = viewName;
            if (viewName === 'create-profile') {
                viewId = 'createProfile';
            }
            
            // Show selected view
            const targetView = document.getElementById(`${viewId}View`);
            if (targetView) {
                targetView.classList.remove('hidden');
                
                // Special handling for specific views
                if (viewName === 'dashboard') {
                    setTimeout(() => {
                        updateDashboardStats();
                    }, 100);
                } else if (viewName === 'profiles') {
                    setTimeout(() => {
                        initializeProfiles();
                    }, 100);
                } else if (viewName === 'create-profile') {
                    setTimeout(() => {
                        initializeCreateProfile();
                    }, 100);
                } else if (viewName === 'proxies') {
                    setTimeout(() => {
                        initializeProxyManagement();
                    }, 100);
                }
            } else {
                console.error(`View not found: ${viewId}View`);
            }
            
            // Update sidebar
            const sidebarItems = document.querySelectorAll('.sidebar-item');
            sidebarItems.forEach(item => {
                item.classList.remove('active');
                if (item.dataset.view === viewName) {
                    item.classList.add('active');
                }
            });
        }

        // Initialize Proxy Manager
        function initializeProxyManager() {
            console.log('Initializing Proxy Manager with Python backend...');
            
            try {
                // Load proxies from Python backend
                loadProxiesFromBackend();
                
                // Setup event listeners for proxy management
                setupProxyEventListeners();
                
                console.log('‚úÖ Proxy Manager initialized with Python backend');
            } catch (error) {
                console.error('‚ùå Error initializing Proxy Manager:', error);
            }
        }

        // Load proxies from Python backend
        async function loadProxiesFromBackend() {
            try {
                console.log('üîÑ Loading proxies from Python backend...');
                
                // Call Python backend through IPC
                const result = await window.electronAPI.invoke('python-local:get-proxies');
                
                if (result && result.success) {
                    console.log('‚úÖ Loaded proxies from backend:', result.data.length);
                    renderProxiesTable(result.data);
                    updateProxyStats(result.data);
                } else {
                    console.error('‚ùå Failed to load proxies:', result?.message);
                    showProxyEmptyState();
                }
            } catch (error) {
                console.error('‚ùå Error loading proxies:', error);
                showProxyEmptyState();
            }
        }

        // Render proxies table
        function renderProxiesTable(proxies) {
            const tbody = document.getElementById('proxyTableBody');
            const emptyState = document.getElementById('proxyEmptyState');
            
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            if (proxies.length === 0) {
                if (emptyState) emptyState.classList.remove('hidden');
                return;
            }
            
            if (emptyState) emptyState.classList.add('hidden');
            
            proxies.forEach(proxy => {
                const row = createProxyRow(proxy);
                tbody.appendChild(row);
            });
        }

        // Create proxy table row
        function createProxyRow(proxy) {
            const row = document.createElement('tr');
            row.className = 'hover:bg-gray-50';
            row.dataset.proxyId = proxy.id;

            const statusClass = getProxyStatusClass(proxy.status);
            const statusText = proxy.status || 'unchecked';
            const authText = proxy.username ? '‚úì' : '‚úó';
            const tagsText = proxy.tags ? (Array.isArray(proxy.tags) ? proxy.tags.join(', ') : proxy.tags) : '';
            const lastUsed = proxy.last_used_at ? new Date(proxy.last_used_at * 1000).toLocaleString() : 'Never';
            const proxyName = proxy.name || `${proxy.host}:${proxy.port}`;

            row.innerHTML = `
                <td class="px-4 py-3">
                    <input type="checkbox" class="proxy-checkbox rounded" data-proxy-id="${proxy.id}">
                </td>
                <td class="px-4 py-3">
                    <div class="font-medium text-gray-900">${proxyName}</div>
                </td>
                <td class="px-4 py-3">
                    <div class="text-gray-900">${proxy.host}:${proxy.port}</div>
                </td>
                <td class="px-4 py-3">
                    <span class="px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full">
                        ${proxy.type.toUpperCase()}
                    </span>
                </td>
                <td class="px-4 py-3 text-center">
                    <span class="${authText === '‚úì' ? 'text-green-600' : 'text-gray-400'}">${authText}</span>
                </td>
                <td class="px-4 py-3">
                    <span class="px-2 py-1 text-xs font-medium rounded-full ${statusClass}">
                        ${statusText.charAt(0).toUpperCase() + statusText.slice(1)}
                    </span>
                </td>
                <td class="px-4 py-3">
                    <div class="text-sm text-gray-600">${tagsText}</div>
                </td>
                <td class="px-4 py-3">
                    <div class="text-sm text-gray-600">${lastUsed}</div>
                </td>
                <td class="px-4 py-3">
                    <div class="flex space-x-2">
                        <button class="text-blue-600 hover:text-blue-800" onclick="editProxy(${proxy.id})" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-purple-600 hover:text-purple-800" onclick="testProxy(${proxy.id})" title="Test">
                            <i class="fas fa-check-circle"></i>
                        </button>
                        <button class="text-red-600 hover:text-red-800" onclick="deleteProxy(${proxy.id})" title="Delete">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            `;

            return row;
        }

        // Get proxy status CSS class
        function getProxyStatusClass(status) {
            switch (status) {
                case 'live':
                    return 'bg-green-100 text-green-800';
                case 'dead':
                    return 'bg-red-100 text-red-800';
                default:
                    return 'bg-gray-100 text-gray-800';
            }
        }

        // Update proxy statistics
        function updateProxyStats(proxies) {
            const total = proxies.length;
            const live = proxies.filter(p => p.status === 'live').length;
            const dead = proxies.filter(p => p.status === 'dead').length;
            const unchecked = proxies.filter(p => !p.status).length;

            const totalEl = document.getElementById('totalProxiesCount');
            const liveEl = document.getElementById('liveProxiesCount');
            const deadEl = document.getElementById('deadProxiesCount');
            const uncheckedEl = document.getElementById('uncheckedProxiesCount');

            if (totalEl) totalEl.textContent = total;
            if (liveEl) liveEl.textContent = live;
            if (deadEl) deadEl.textContent = dead;
            if (uncheckedEl) uncheckedEl.textContent = unchecked;
        }

        // Show empty state
        function showProxyEmptyState() {
            const emptyState = document.getElementById('proxyEmptyState');
            if (emptyState) emptyState.classList.remove('hidden');
        }

        // Setup proxy event listeners
        function setupProxyEventListeners() {
            // Add Proxy button
            const addProxyBtn = document.getElementById('addProxyBtn');
            if (addProxyBtn) {
                addProxyBtn.addEventListener('click', showAddProxyModal);
            }

            // Import Proxy button
            const importProxyBtn = document.getElementById('importProxyBtn');
            if (importProxyBtn) {
                importProxyBtn.addEventListener('click', showImportProxyModal);
            }

            // Modal close buttons
            const closeAddModal = document.getElementById('closeAddProxyModal');
            const cancelAddProxy = document.getElementById('cancelAddProxy');
            if (closeAddModal) closeAddModal.addEventListener('click', hideAddProxyModal);
            if (cancelAddProxy) cancelAddProxy.addEventListener('click', hideAddProxyModal);

            // Save proxy buttons
            const saveAddProxy = document.getElementById('saveAddProxy');
            const testAddProxy = document.getElementById('testAddProxy');
            if (saveAddProxy) saveAddProxy.addEventListener('click', saveNewProxy);
            if (testAddProxy) testAddProxy.addEventListener('click', testAndAddProxy);
        }

        // Show add proxy modal
        function showAddProxyModal() {
            const modal = document.getElementById('addProxyModal');
            if (modal) {
                modal.classList.remove('hidden');
                const nameField = document.getElementById('proxyName');
                if (nameField) nameField.focus();
            }
        }

        // Hide add proxy modal
        function hideAddProxyModal() {
            const modal = document.getElementById('addProxyModal');
            if (modal) {
                modal.classList.add('hidden');
                const form = document.getElementById('addProxyForm');
                if (form) form.reset();
            }
        }

        // Show import proxy modal
        function showImportProxyModal() {
            const modal = document.getElementById('importProxyModal');
            if (modal) {
                modal.classList.remove('hidden');
                const textArea = document.getElementById('importProxyText');
                if (textArea) textArea.focus();
            }
        }

        // Save new proxy
        async function saveNewProxy() {
            try {
                const proxyData = getProxyFormData();
                if (!validateProxyData(proxyData)) return;

                console.log('üîÑ Adding new proxy via Python backend:', proxyData);
                
                const result = await window.electronAPI.invoke('python-local:create-proxy', proxyData);
                
                if (result && result.success) {
                    showNotification('Proxy ƒë√£ ƒë∆∞·ª£c th√™m th√†nh c√¥ng!', 'success');
                    hideAddProxyModal();
                    await loadProxiesFromBackend();
                } else {
                    showNotification('L·ªói khi th√™m proxy: ' + (result?.message || 'Unknown error'), 'error');
                }
            } catch (error) {
                console.error('‚ùå Error adding proxy:', error);
                showNotification('L·ªói khi th√™m proxy: ' + error.message, 'error');
            }
        }
                }
            } catch (error) {
                console.error('‚ùå Error adding proxy:', error);
                showNotification('L·ªói khi th√™m proxy: ' + error.message, 'error');
            }
        }

        // Test and add proxy
        async function testAndAddProxy() {
            try {
                const proxyData = getProxyFormData();
                if (!validateProxyData(proxyData)) return;

                console.log('üîÑ Testing and adding proxy via Python backend:', proxyData);
                
                showNotification('ƒêang test proxy...', 'info');
                
                // For now, just add the proxy - testing will be implemented later
                const result = await window.electronAPI.invoke('python-local:create-proxy', proxyData);
                
                if (result && result.success) {
                    showNotification('Proxy ƒë√£ ƒë∆∞·ª£c test v√† th√™m th√†nh c√¥ng!', 'success');
                    hideAddProxyModal();
                    await loadProxiesFromBackend();
                } else {
                    showNotification('L·ªói khi th√™m proxy: ' + (result?.message || 'Unknown error'), 'error');
                }
            } catch (error) {
                console.error('‚ùå Error testing proxy:', error);
                showNotification('L·ªói khi test proxy: ' + error.message, 'error');
            }
        }

        // Get proxy form data
        function getProxyFormData() {
            const nameField = document.getElementById('proxyName');
            const hostField = document.getElementById('proxyHost');
            const portField = document.getElementById('proxyPort');
            const typeField = document.getElementById('proxyType');
            const usernameField = document.getElementById('proxyUsername');
            const passwordField = document.getElementById('proxyPassword');
            const tagsField = document.getElementById('proxyTags');

            const tags = tagsField?.value ? tagsField.value.split(',').map(t => t.trim()).filter(t => t) : [];

            return {
                name: nameField?.value?.trim() || null,
                host: hostField?.value?.trim() || '',
                port: parseInt(portField?.value) || 0,
                type: typeField?.value || 'http',
                username: usernameField?.value?.trim() || '',
                password: passwordField?.value?.trim() || '',
                tags: tags.length > 0 ? tags : ['Default']
            };
        }

        // Validate proxy data
        function validateProxyData(data) {
            if (!data.host) {
                showNotification('Host l√† b·∫Øt bu·ªôc', 'error');
                return false;
            }

            if (!data.port || data.port < 1 || data.port > 65535) {
                showNotification('Port h·ª£p l·ªá (1-65535) l√† b·∫Øt bu·ªôc', 'error');
                return false;
            }

            return true;
        }

        // Proxy action functions
        async function editProxy(proxyId) {
            console.log('Edit proxy:', proxyId);
            showNotification('Ch·ª©c nƒÉng ch·ªânh s·ª≠a proxy s·∫Ω ƒë∆∞·ª£c tri·ªÉn khai s·ªõm', 'info');
        }

        async function testProxy(proxyId) {
            console.log('Test proxy:', proxyId);
            showNotification('ƒêang test proxy...', 'info');
            // Testing functionality will be implemented
        }

        async function deleteProxy(proxyId) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a proxy n√†y?')) {
                return;
            }

            try {
                console.log('üîÑ Deleting proxy:', proxyId);
                
                const result = await window.electronAPI.invoke('python-local:delete-proxy', proxyId);
                
                if (result && result.success) {
                    showNotification('Proxy ƒë√£ ƒë∆∞·ª£c x√≥a th√†nh c√¥ng!', 'success');
                    await loadProxiesFromBackend();
                } else {
                    showNotification('L·ªói khi x√≥a proxy: ' + (result?.message || 'Unknown error'), 'error');
                }
            } catch (error) {
                console.error('‚ùå Error deleting proxy:', error);
                showNotification('L·ªói khi x√≥a proxy: ' + error.message, 'error');
            }
        }

        // Show notification
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-green-500 text-white' :
                type === 'error' ? 'bg-red-500 text-white' :
                'bg-blue-500 text-white'
            }`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM loaded, setting up event listeners...');
            
            // Test proxy buttons immediately
            setTimeout(() => {
                console.log('üîç Testing proxy buttons...');
                const addBtn = document.getElementById('addProxyBtn');
                const importBtn = document.getElementById('importProxyBtn');
                
                if (addBtn) {
                    console.log('‚úÖ Add Proxy button found');
                } else {
                    console.warn('‚ö†Ô∏è Add Proxy button NOT found');
                }
                
                if (importBtn) {
                    console.log('‚úÖ Import Proxy button found');
                } else {
                    console.warn('‚ö†Ô∏è Import Proxy button NOT found');
                }
                
                // Force bind proxy events if buttons exist
                if (addBtn || importBtn) {
                    console.log('üîß Force binding proxy events...');
                    bindProxyEvents();
                }
            }, 500);
            
            // Wait for MainRenderer to initialize first
            setTimeout(() => {
                // Only initialize if MainRenderer is not available or failed to initialize
                if (!window.mainRenderer) {
                    console.log('MainRenderer not available, using fallback initialization...');
                    initializeFallbackEvents();
                }
            }, 1000);
        });

        // Global error handler
        window.addEventListener('error', (e) => {
            console.error(`Global Error: ${e.message} at ${e.filename}:${e.lineno}`);
        });

            // Fallback event initialization when MainRenderer is not available
        function initializeFallbackEvents() {
            console.log('Initializing fallback events...');
            
            // Sidebar navigation
            const sidebarItems = document.querySelectorAll('.sidebar-item');
            sidebarItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const viewName = item.dataset.view;
                    switchView(viewName);
                });
            });

            // Tab navigation
            const tabButtons = document.querySelectorAll('.tab-btn');
            tabButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const tab = e.target.dataset.tab;
                    if (tab) {
                        switchTab(tab);
                    }
                });
            });

            // Create Profile tab navigation
            const createTabButtons = document.querySelectorAll('.create-tab-btn');
            createTabButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const tab = e.target.dataset.tab;
                    if (tab) {
                        switchCreateTab(tab);
                    }
                });
            });

            // Create Profile proxy type handling
            const createProxyRadios = document.querySelectorAll('input[name="createProxyType"]');
            createProxyRadios.forEach(radio => {
                radio.addEventListener('change', (e) => {
                    handleCreateProxyTypeChange(e.target.value);
                });
            });

            // Create Profile buttons
            const createCancelBtn = document.getElementById('createCancelBtn');
            const createSaveBtn = document.getElementById('createSaveProfileBtn');
            
            if (createCancelBtn) {
                createCancelBtn.addEventListener('click', () => {
                    switchView('profiles');
                });
            }
            
            if (createSaveBtn) {
                createSaveBtn.addEventListener('click', () => {
                    handleCreateProfile();
                });
            }

            // Refresh button
            const refreshBtn = document.getElementById('refreshProfilesBtn');
            if (refreshBtn) {
                refreshBtn.addEventListener('click', () => {
                    console.log('Manual refresh triggered');
                    initializeProfiles();
                });
            }

            // Initialize proxy management events
            initializeProxyManagement();
            
            console.log('‚úÖ Fallback events initialized');
        }

        // Initialize Proxy Management - s·ª≠ d·ª•ng Python backend
        function initializeProxyManagement() {
            console.log('üîÑ Initializing Proxy Management with Python backend...');
            
            try {
                // Bind events cho proxy management
                bindProxyEvents();
                
                // Load proxies t·ª´ backend
                loadProxiesFromBackend();
                
                console.log('‚úÖ Proxy Management initialized with Python backend');
            } catch (error) {
                console.error('‚ùå Error initializing Proxy Management:', error);
            }
        }

        // Load proxies t·ª´ Python backend
        async function loadProxiesFromBackend() {
            try {
                showProxyLoadingState();
                
                const result = await window.electronAPI.invoke('db:proxy:get-all');
                
                if (result && result.success) {
                    const proxies = result.data || [];
                    renderProxiesTable(proxies);
                    updateProxyStats(proxies);
                    hideProxyLoadingState();
                } else {
                    console.error('‚ùå Failed to load proxies:', result?.message);
                    showProxyError('Failed to load proxies: ' + (result?.message || 'Unknown error'));
                    hideProxyLoadingState();
                }
            } catch (error) {
                console.error('‚ùå Error loading proxies:', error);
                showProxyError('Error loading proxies: ' + error.message);
                hideProxyLoadingState();
            }
        }

        // Render b·∫£ng proxy
        function renderProxiesTable(proxies) {
            const tbody = document.getElementById('proxyTableBody');
            const emptyState = document.getElementById('proxyEmptyState');
            
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            if (proxies.length === 0) {
                if (emptyState) emptyState.classList.remove('hidden');
                return;
            }
            
            if (emptyState) emptyState.classList.add('hidden');
            
            proxies.forEach(proxy => {
                const row = createProxyRow(proxy);
                tbody.appendChild(row);
            });
        }

        // T·∫°o row cho proxy
        function createProxyRow(proxy) {
            const row = document.createElement('tr');
            row.className = 'hover:bg-gray-50';
            row.dataset.proxyId = proxy.id;

            const statusClass = getProxyStatusClass(proxy.status);
            const statusText = proxy.status || 'unchecked';
            const authText = proxy.username ? '‚úì' : '‚úó';
            const tagsText = proxy.tags ? proxy.tags.join(', ') : '';
            const lastUsed = proxy.last_used_at ? new Date(proxy.last_used_at * 1000).toLocaleString() : 'Never';

            row.innerHTML = `
                <td class="px-4 py-3">
                    <input type="checkbox" class="proxy-checkbox rounded" data-proxy-id="${proxy.id}">
                </td>
                <td class="px-4 py-3">
                    <div class="font-medium text-gray-900">${proxy.name || `${proxy.host}:${proxy.port}`}</div>
                </td>
                <td class="px-4 py-3">
                    <div class="text-gray-900">${proxy.host}:${proxy.port}</div>
                </td>
                <td class="px-4 py-3">
                    <span class="px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full">
                        ${proxy.type.toUpperCase()}
                    </span>
                </td>
                <td class="px-4 py-3 text-center">
                    <span class="${authText === '‚úì' ? 'text-green-600' : 'text-gray-400'}">${authText}</span>
                </td>
                <td class="px-4 py-3">
                    <span class="px-2 py-1 text-xs font-medium rounded-full ${statusClass}">
                        ${statusText.charAt(0).toUpperCase() + statusText.slice(1)}
                    </span>
                </td>
                <td class="px-4 py-3">
                    <div class="text-sm text-gray-600">${tagsText}</div>
                </td>
                <td class="px-4 py-3">
                    <div class="text-sm text-gray-600">${lastUsed}</div>
                </td>
                <td class="px-4 py-3">
                    <div class="flex space-x-2">
                        <button class="text-blue-600 hover:text-blue-800" onclick="editProxy(${proxy.id})" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-purple-600 hover:text-purple-800" onclick="testProxy(${proxy.id})" title="Test">
                            <i class="fas fa-check-circle"></i>
                        </button>
                        <button class="text-red-600 hover:text-red-800" onclick="deleteProxy('${proxy.host}', ${proxy.port})" title="Delete">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            `;

            return row;
        }

        // Get status class cho proxy
        function getProxyStatusClass(status) {
            switch (status) {
                case 'live':
                    return 'bg-green-100 text-green-800';
                case 'dead':
                    return 'bg-red-100 text-red-800';
                default:
                    return 'bg-gray-100 text-gray-800';
            }
        }

        // Update proxy stats
        function updateProxyStats(proxies) {
            const total = proxies.length;
            const live = proxies.filter(p => p.status === 'live').length;
            const dead = proxies.filter(p => p.status === 'dead').length;
            const unchecked = proxies.filter(p => !p.status).length;

            document.getElementById('totalProxiesCount').textContent = total;
            document.getElementById('liveProxiesCount').textContent = live;
            document.getElementById('deadProxiesCount').textContent = dead;
            document.getElementById('uncheckedProxiesCount').textContent = unchecked;
        }

        // Test function ƒë·ªÉ ki·ªÉm tra proxy buttons
        function testProxyButtons() {
            console.log('üß™ Testing proxy buttons...');
            
            const addBtn = document.getElementById('addProxyBtn');
            const importBtn = document.getElementById('importProxyBtn');
            
            if (addBtn) {
                console.log('‚úÖ Add Proxy button found, adding test click handler');
                addBtn.onclick = function() {
                    console.log('üéØ Add Proxy button clicked!');
                    showAddProxyModal();
                };
            }
            
            if (importBtn) {
                console.log('‚úÖ Import Proxy button found, adding test click handler');
                importBtn.onclick = function() {
                    console.log('üéØ Import Proxy button clicked!');
                    showImportProxyModal();
                };
            }
        }

        // Bind proxy events
        function bindProxyEvents() {
            console.log('üîÑ Binding proxy events...');
            
            // Add Proxy button
            const addProxyBtn = document.getElementById('addProxyBtn');
            if (addProxyBtn) {
                // Remove existing listeners first to avoid duplicates
                addProxyBtn.removeEventListener('click', showAddProxyModal);
                addProxyBtn.addEventListener('click', showAddProxyModal);
                console.log('‚úÖ Add Proxy button event bound');
            } else {
                console.warn('‚ö†Ô∏è Add Proxy button not found');
            }
            
            // Import Proxy button
            const importProxyBtn = document.getElementById('importProxyBtn');
            if (importProxyBtn) {
                // Remove existing listeners first to avoid duplicates
                importProxyBtn.removeEventListener('click', showImportProxyModal);
                importProxyBtn.addEventListener('click', showImportProxyModal);
                console.log('‚úÖ Import Proxy button event bound');
            } else {
                console.warn('‚ö†Ô∏è Import Proxy button not found');
            }
            
            // Modal close events
            const closeAddModal = document.getElementById('closeAddProxyModal');
            const cancelAddProxy = document.getElementById('cancelAddProxy');
            const saveAddProxy = document.getElementById('saveAddProxy');
            const testAddProxy = document.getElementById('testAddProxy');
            
            if (closeAddModal) closeAddModal.addEventListener('click', hideAddProxyModal);
            if (cancelAddProxy) cancelAddProxy.addEventListener('click', hideAddProxyModal);
            if (saveAddProxy) saveAddProxy.addEventListener('click', saveNewProxy);
            if (testAddProxy) testAddProxy.addEventListener('click', testAndAddProxy);
            
            // Import modal events
            const closeImportModal = document.getElementById('closeImportProxyModal');
            const cancelImportProxy = document.getElementById('cancelImportProxy');
            const saveImportProxy = document.getElementById('saveImportProxy');
            const importProxyText = document.getElementById('importProxyText');
            
            if (closeImportModal) closeImportModal.addEventListener('click', hideImportProxyModal);
            if (cancelImportProxy) cancelImportProxy.addEventListener('click', hideImportProxyModal);
            if (saveImportProxy) saveImportProxy.addEventListener('click', saveImportProxies);
            if (importProxyText) importProxyText.addEventListener('input', updateImportPreview);
            
            console.log('‚úÖ All proxy events bound successfully');
        }

        // Modal functions
        function showAddProxyModal() {
            console.log('üîÑ Opening Add Proxy Modal...');
            const modal = document.getElementById('addProxyModal');
            if (modal) {
                modal.classList.remove('hidden');
                const nameField = document.getElementById('proxyName');
                if (nameField) nameField.focus();
                console.log('‚úÖ Add Proxy Modal opened');
            } else {
                console.error('‚ùå Add Proxy Modal not found');
            }
        }

        function hideAddProxyModal() {
            console.log('üîÑ Closing Add Proxy Modal...');
            const modal = document.getElementById('addProxyModal');
            if (modal) {
                modal.classList.add('hidden');
                const form = document.getElementById('addProxyForm');
                if (form) form.reset();
                console.log('‚úÖ Add Proxy Modal closed');
            }
        }

        function showImportProxyModal() {
            console.log('üîÑ Opening Import Proxy Modal...');
            const modal = document.getElementById('importProxyModal');
            if (modal) {
                modal.classList.remove('hidden');
                const textField = document.getElementById('importProxyText');
                if (textField) textField.focus();
                console.log('‚úÖ Import Proxy Modal opened');
            } else {
                console.error('‚ùå Import Proxy Modal not found');
            }
        }

        function hideImportProxyModal() {
            console.log('üîÑ Closing Import Proxy Modal...');
            const modal = document.getElementById('importProxyModal');
            if (modal) {
                modal.classList.add('hidden');
                const textField = document.getElementById('importProxyText');
                const tagsField = document.getElementById('importTags');
                const previewCount = document.getElementById('importPreviewCount');
                const saveBtn = document.getElementById('saveImportProxy');
                
                if (textField) textField.value = '';
                if (tagsField) tagsField.value = '';
                if (previewCount) previewCount.textContent = '0';
                if (saveBtn) saveBtn.disabled = true;
                console.log('‚úÖ Import Proxy Modal closed');
            }
        }

        // Save new proxy
        async function saveNewProxy() {
            try {
                const proxyData = getProxyFormData();
                
                if (!validateProxyData(proxyData)) {
                    return;
                }

                console.log('üîÑ Adding new proxy:', proxyData);
                const result = await window.electronAPI.invoke('db:proxy:add', proxyData);
                
                if (result.success) {
                    showNotification('Proxy ƒë√£ ƒë∆∞·ª£c th√™m th√†nh c√¥ng!', 'success');
                    hideAddProxyModal();
                    await loadProxiesFromBackend();
                } else {
                    showNotification('L·ªói khi th√™m proxy: ' + result.message, 'error');
                }
            } catch (error) {
                console.error('‚ùå Error adding proxy:', error);
                showNotification('L·ªói khi th√™m proxy: ' + error.message, 'error');
            }
        }

        // Test and add proxy
        async function testAndAddProxy() {
            try {
                const proxyData = getProxyFormData();
                
                if (!validateProxyData(proxyData)) {
                    return;
                }

                showNotification('ƒêang test proxy...', 'info');
                
                // T·∫°m th·ªùi ch·ªâ th√™m proxy - ch·ª©c nƒÉng test s·∫Ω ƒë∆∞·ª£c implement sau
                console.log('üîÑ Testing and adding proxy:', proxyData);
                const result = await window.electronAPI.invoke('db:proxy:add', proxyData);
                
                if (result.success) {
                    showNotification('Proxy ƒë√£ ƒë∆∞·ª£c test v√† th√™m th√†nh c√¥ng!', 'success');
                    hideAddProxyModal();
                    await loadProxiesFromBackend();
                } else {
                    showNotification('L·ªói khi th√™m proxy: ' + result.message, 'error');
                }
            } catch (error) {
                console.error('‚ùå Error testing proxy:', error);
                showNotification('L·ªói khi test proxy: ' + error.message, 'error');
            }
        }

        // Get proxy form data
        function getProxyFormData() {
            const nameField = document.getElementById('proxyName');
            const hostField = document.getElementById('proxyHost');
            const portField = document.getElementById('proxyPort');
            const typeField = document.getElementById('proxyType');
            const usernameField = document.getElementById('proxyUsername');
            const passwordField = document.getElementById('proxyPassword');
            const tagsField = document.getElementById('proxyTags');

            const tags = tagsField.value ? tagsField.value.split(',').map(t => t.trim()).filter(t => t) : [];

            return {
                name: nameField.value.trim() || null,
                host: hostField.value.trim(),
                port: parseInt(portField.value),
                type: typeField.value,
                username: usernameField.value.trim(),
                password: passwordField.value.trim(),
                tags: tags.length > 0 ? tags : ['Default']
            };
        }

        // Validate proxy data
        function validateProxyData(data) {
            if (!data.host) {
                showNotification('Host l√† b·∫Øt bu·ªôc', 'error');
                return false;
            }

            if (!data.port || data.port < 1 || data.port > 65535) {
                showNotification('Port ph·∫£i trong kho·∫£ng 1-65535', 'error');
                return false;
            }

            return true;
        }

        // Import functions
        function updateImportPreview() {
            const text = document.getElementById('importProxyText').value;
            const lines = text.split('\n').filter(line => line.trim());
            
            document.getElementById('importPreviewCount').textContent = lines.length;
            document.getElementById('saveImportProxy').disabled = lines.length === 0;
        }

        async function saveImportProxies() {
            try {
                const text = document.getElementById('importProxyText').value;
                const format = document.getElementById('importFormat').value;
                const defaultTags = document.getElementById('importTags').value;
                const lines = text.split('\n').filter(line => line.trim());
                
                if (lines.length === 0) {
                    showNotification('Vui l√≤ng nh·∫≠p danh s√°ch proxy', 'error');
                    return;
                }

                // Parse proxies
                const parsedProxies = parseProxyList(lines, format);
                const validProxies = parsedProxies.filter(p => p.valid);
                
                if (validProxies.length === 0) {
                    showNotification('Kh√¥ng t√¨m th·∫•y proxy h·ª£p l·ªá', 'error');
                    return;
                }

                // Add default tags
                const tags = defaultTags ? defaultTags.split(',').map(t => t.trim()).filter(t => t) : [];
                
                const proxiesToAdd = validProxies.map(p => ({
                    ...p.data,
                    tags: tags.length > 0 ? tags : ['Imported']
                }));

                console.log('üîÑ Importing proxies:', proxiesToAdd);

                // Bulk add proxies
                const result = await window.electronAPI.invoke('db:proxy:bulk-add', proxiesToAdd);
                
                if (result.success) {
                    const { successCount, totalCount } = result.data;
                    showNotification(`ƒê√£ import th√†nh c√¥ng ${successCount}/${totalCount} proxy`, 'success');
                    hideImportProxyModal();
                    await loadProxiesFromBackend();
                } else {
                    showNotification('L·ªói khi import proxy: ' + result.message, 'error');
                }
            } catch (error) {
                console.error('‚ùå Error importing proxies:', error);
                showNotification('L·ªói khi import proxy: ' + error.message, 'error');
            }
        }

        // Parse proxy list
        function parseProxyList(lines, format) {
            return lines.map(line => {
                try {
                    const trimmed = line.trim();
                    if (!trimmed) return { valid: false };

                    let host, port, username = '', password = '', type = 'http';

                    switch (format) {
                        case 'host:port':
                            [host, port] = trimmed.split(':');
                            break;
                        
                        case 'host:port:username:password':
                            [host, port, username, password] = trimmed.split(':');
                            break;
                        
                        case 'type://host:port':
                            const match1 = trimmed.match(/^(\w+):\/\/([^:]+):(\d+)$/);
                            if (match1) {
                                [, type, host, port] = match1;
                            }
                            break;
                        
                        case 'type://host:port:username:password':
                            const match2 = trimmed.match(/^(\w+):\/\/([^:]+):(\d+):([^:]*):(.*)$/);
                            if (match2) {
                                [, type, host, port, username, password] = match2;
                            }
                            break;
                        
                        case 'type://username:password@host:port':
                            const match3 = trimmed.match(/^(\w+):\/\/([^:]*):([^@]*)@([^:]+):(\d+)$/);
                            if (match3) {
                                [, type, username, password, host, port] = match3;
                            }
                            break;
                    }

                    if (!host || !port || isNaN(port)) {
                        return { valid: false };
                    }

                    return {
                        valid: true,
                        data: {
                            host: host.trim(),
                            port: parseInt(port),
                            username: username || '',
                            password: password || '',
                            type: type.toLowerCase()
                        }
                    };
                } catch (error) {
                    return { valid: false };
                }
            });
        }

        // Delete proxy
        async function deleteProxy(host, port) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a proxy n√†y?')) {
                return;
            }

            try {
                const result = await window.electronAPI.invoke('db:proxy:delete', host, port);
                
                if (result.success) {
                    showNotification('Proxy ƒë√£ ƒë∆∞·ª£c x√≥a th√†nh c√¥ng', 'success');
                    await loadProxiesFromBackend();
                } else {
                    showNotification('L·ªói khi x√≥a proxy: ' + result.message, 'error');
                }
            } catch (error) {
                console.error('‚ùå Error deleting proxy:', error);
                showNotification('L·ªói khi x√≥a proxy: ' + error.message, 'error');
            }
        }

        // Test proxy
        async function testProxy(proxyId) {
            showNotification('ƒêang test proxy...', 'info');
            // Testing functionality s·∫Ω ƒë∆∞·ª£c implement sau
        }

        // Edit proxy
        async function editProxy(proxyId) {
            showNotification('Ch·ª©c nƒÉng edit proxy s·∫Ω ƒë∆∞·ª£c implement sau', 'info');
        }

        // Utility functions
        function showProxyLoadingState() {
            document.getElementById('proxyLoadingState')?.classList.remove('hidden');
            document.getElementById('proxyEmptyState')?.classList.add('hidden');
        }

        function hideProxyLoadingState() {
            document.getElementById('proxyLoadingState')?.classList.add('hidden');
        }

        function showProxyError(message) {
            showNotification(message, 'error');
        }

        function showNotification(message, type = 'info') {
            // Simple notification - c√≥ th·ªÉ enhance sau
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-green-500 text-white' :
                type === 'error' ? 'bg-red-500 text-white' :
                'bg-blue-500 text-white'
            }`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Initialize proxy manager when switching to proxies view
        function initializeProxyManager() {
            console.log('Initializing Proxy Manager with Python backend...');
            
            try {
                // Load proxies t·ª´ Python backend
                loadProxiesFromBackend();
                
                console.log('‚úÖ Proxy Manager initialized with Python backend');
            } catch (error) {
                console.error('‚ùå Error initializing Proxy Manager:', error);
            }
        }

            // Initialize profiles view
            setTimeout(() => {
                console.log('üîÑ Starting profile initialization...');
                
                if (typeof ProfilesStructure !== 'undefined' && typeof ProfilesView !== 'undefined') {
                    console.log('‚úÖ Profile classes available, using ProfilesView to load from database');
                    initializeProfiles();
                } else {
                    console.warn('‚ö†Ô∏è Profile classes not loaded, trying direct initialization...');
                    setTimeout(() => {
                        if (typeof ProfilesStructure !== 'undefined' && typeof ProfilesView !== 'undefined') {
                            initializeProfiles();
                        } else {
                            console.error('‚ùå Profile classes still not available after delay');
                            const profilesContainer = document.getElementById('profilesView');
                            if (profilesContainer) {
                                profilesContainer.innerHTML = `
                                    <div class="flex items-center justify-center h-64">
                                        <div class="text-center">
                                            <div class="text-red-500 text-6xl mb-4">‚ö†Ô∏è</div>
                                            <h3 class="text-xl font-bold text-gray-800 mb-2">Error Loading Profiles</h3>
                                            <p class="text-gray-600 mb-4">ProfilesView classes not found. Please check console for details.</p>
                                            <button onclick="location.reload()" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">
                                                üîÑ Reload Page
                                            </button>
                                        </div>
                                    </div>
                                `;
                            }
                        }
                    }, 1000);
                }
                
                initializeCreateProfile();
                
                // Update dashboard stats on initial load (since dashboard is default view)
                updateDashboardStats();
            }, 500);
        }

        console.log('PMLogin Dashboard loaded');
    </script>

    <!-- Load MainRenderer for settings dropdown and other functionality -->
    <script src="./renderer.js"></script>

    <script>
        // Initialize Profiles function - Using ProfilesView to load from database
        function initializeProfiles() {
            console.log('üîÑ Initializing ProfilesView to load from database...');
            
            try {
                // Debug: Check what's available in global scope
                console.log('üîç Available classes:');
                console.log('  - ProfilesStructure:', typeof ProfilesStructure);
                console.log('  - ProfilesView:', typeof ProfilesView);
                
                // Check if required classes are available
                if (typeof ProfilesStructure === 'undefined') {
                    console.error('‚ùå ProfilesStructure class not found');
                    throw new Error('ProfilesStructure class not found');
                }
                
                if (typeof ProfilesView === 'undefined') {
                    console.error('‚ùå ProfilesView class not found');
                    throw new Error('ProfilesView class not found');
                }
                
                const profilesContainer = document.getElementById('profilesView');
                if (!profilesContainer) {
                    console.error('‚ùå Profiles container not found');
                    return;
                }
                
                // Destroy existing instance if any
                if (window.profilesViewInstance && window.profilesViewInstance.destroy) {
                    console.log('üóëÔ∏è Destroying existing ProfilesView instance...');
                    window.profilesViewInstance.destroy();
                }
                
                // Create new ProfilesView instance (loads from database)
                console.log('üîÑ Creating ProfilesView instance to load from database...');
                window.profilesViewInstance = new ProfilesView(profilesContainer);
                
                console.log('‚úÖ ProfilesView initialized successfully - data loaded from database');
                
            } catch (error) {
                console.error('‚ùå Error initializing ProfilesView:', error);
                
                // Show error in profiles container
                const profilesContainer = document.getElementById('profilesView');
                if (profilesContainer) {
                    profilesContainer.innerHTML = `
                        <div class="flex items-center justify-center h-64">
                            <div class="text-center">
                                <div class="text-red-500 text-6xl mb-4">‚ö†Ô∏è</div>
                                <h3 class="text-xl font-bold text-gray-800 mb-2">Error Loading Profiles</h3>
                                <p class="text-gray-600 mb-4">Failed to initialize profiles view: ${error.message}</p>
                                <button onclick="location.reload()" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">
                                    üîÑ Reload Page
                                </button>
                            </div>
                        </div>
                    `;
                }
            }
        }
        
        // Initialize Create Profile function
        function initializeCreateProfile() {
            console.log('üîÑ Initializing Create Profile...');
            // This function can be implemented later if needed
        }
    </script>
</body>
</html>
        // Load proxies t·ª´ Python backend
        async function loadProxiesFromBackend() {
            try {
                showProxyLoadingState();
                
                console.log('üîÑ Loading proxies from Python backend...');
                const result = await window.electronAPI.invoke('python-local:get-proxies');
                
                if (result && result.success) {
                    const proxies = result.data || [];
                    renderProxies(proxies);
                    updateProxyStats(proxies);
                    console.log(`‚úÖ Loaded ${proxies.length} proxies from Python backend`);
                } else {
                    console.error('‚ùå Failed to load proxies:', result?.message);
                    showNotification('L·ªói khi t·∫£i danh s√°ch proxy: ' + (result?.message || 'Unknown error'), 'error');
                    showProxyEmptyState();
                }
            } catch (error) {
                console.error('‚ùå Error loading proxies from backend:', error);
                showNotification('Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn Python backend. Vui l√≤ng ki·ªÉm tra server ƒëang ch·∫°y.', 'error');
                showProxyEmptyState();
            } finally {
                hideProxyLoadingState();
            }
        }

        // Render proxies table
        function renderProxies(proxies) {
            const tbody = document.getElementById('proxyTableBody');
            const emptyState = document.getElementById('proxyEmptyState');
            
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            if (proxies.length === 0) {
                if (emptyState) emptyState.classList.remove('hidden');
                return;
            }
            
            if (emptyState) emptyState.classList.add('hidden');
            
            proxies.forEach(proxy => {
                const row = createProxyRow(proxy);
                tbody.appendChild(row);
            });
        }

        // T·∫°o row cho proxy
        function createProxyRow(proxy) {
            const row = document.createElement('tr');
            row.className = 'hover:bg-gray-50';
            row.dataset.proxyId = proxy.id;

            const statusClass = getProxyStatusClass(proxy.status);
            const statusText = proxy.status || 'unchecked';
            const authText = proxy.username ? '‚úì' : '‚úó';
            const tagsText = proxy.tags ? proxy.tags.join(', ') : '';
            const lastUsed = proxy.last_used_at ? new Date(proxy.last_used_at * 1000).toLocaleString() : 'Never';

            row.innerHTML = `
                <td class="px-4 py-3">
                    <input type="checkbox" class="proxy-checkbox rounded" data-proxy-id="${proxy.id}">
                </td>
                <td class="px-4 py-3">
                    <div class="font-medium text-gray-900">${proxy.name || `${proxy.host}:${proxy.port}`}</div>
                </td>
                <td class="px-4 py-3">
                    <div class="text-gray-900">${proxy.host}:${proxy.port}</div>
                </td>
                <td class="px-4 py-3">
                    <span class="px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full">
                        ${proxy.type.toUpperCase()}
                    </span>
                </td>
                <td class="px-4 py-3 text-center">
                    <span class="${authText === '‚úì' ? 'text-green-600' : 'text-gray-400'}">${authText}</span>
                </td>
                <td class="px-4 py-3">
                    <span class="px-2 py-1 text-xs font-medium rounded-full ${statusClass}">
                        ${statusText.charAt(0).toUpperCase() + statusText.slice(1)}
                    </span>
                </td>
                <td class="px-4 py-3">
                    <div class="text-sm text-gray-600">${tagsText}</div>
                </td>
                <td class="px-4 py-3">
                    <div class="text-sm text-gray-600">${lastUsed}</div>
                </td>
                <td class="px-4 py-3">
                    <div class="flex space-x-2">
                        <button class="text-blue-600 hover:text-blue-800" onclick="editProxy(${proxy.id})" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-purple-600 hover:text-purple-800" onclick="testProxy(${proxy.id})" title="Test">
                            <i class="fas fa-check-circle"></i>
                        </button>
                        <button class="text-red-600 hover:text-red-800" onclick="deleteProxy('${proxy.host}', ${proxy.port})" title="Delete">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            `;

            return row;
        }

        // Get status class cho proxy
        function getProxyStatusClass(status) {
            switch (status) {
                case 'live':
                    return 'bg-green-100 text-green-800';
                case 'dead':
                    return 'bg-red-100 text-red-800';
                default:
                    return 'bg-gray-100 text-gray-800';
            }
        }

        // Loading states
        function showProxyLoadingState() {
            const loadingState = document.getElementById('proxyLoadingState');
            const emptyState = document.getElementById('proxyEmptyState');
            if (loadingState) loadingState.classList.remove('hidden');
            if (emptyState) emptyState.classList.add('hidden');
        }

        function hideProxyLoadingState() {
            const loadingState = document.getElementById('proxyLoadingState');
            if (loadingState) loadingState.classList.add('hidden');
        }

        function showProxyEmptyState() {
            const emptyState = document.getElementById('proxyEmptyState');
            if (emptyState) emptyState.classList.remove('hidden');
        }

        // Delete proxy
        async function deleteProxy(host, port) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a proxy n√†y?')) {
                return;
            }

            try {
                console.log(`üîÑ Deleting proxy: ${host}:${port}`);
                const result = await window.electronAPI.invoke('python-local:delete-proxy', { host, port });
                
                if (result && result.success) {
                    showNotification('Proxy ƒë√£ ƒë∆∞·ª£c x√≥a th√†nh c√¥ng', 'success');
                    await loadProxiesFromBackend();
                } else {
                    showNotification('L·ªói khi x√≥a proxy: ' + (result?.message || 'Unknown error'), 'error');
                }
            } catch (error) {
                console.error('‚ùå Error deleting proxy:', error);
                showNotification('L·ªói khi x√≥a proxy: ' + error.message, 'error');
            }
        }

        // Test proxy (placeholder)
        function testProxy(proxyId) {
            showNotification('Ch·ª©c nƒÉng test proxy s·∫Ω ƒë∆∞·ª£c implement sau', 'info');
        }

        // Edit proxy (placeholder)
        function editProxy(proxyId) {
            showNotification('Ch·ª©c nƒÉng edit proxy s·∫Ω ƒë∆∞·ª£c implement sau', 'info');
        }